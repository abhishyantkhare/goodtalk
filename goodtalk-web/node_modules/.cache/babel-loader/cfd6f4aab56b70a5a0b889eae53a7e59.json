{"ast":null,"code":"var _jsxFileName = \"/Users/planetexpress/Documents/Projects/Personal/goodtalk/goodtalk-web/src/components/videochat/videochat.js\";\nimport React, { useEffect, useState } from \"react\";\nimport { useLocation } from \"react-router-dom\";\nimport \"./videochat.css\";\nimport InviteAlert from \"../invitealert/invitealert\";\nimport { Stack } from \"grommet\";\nconst BACKEND_URL = process.env.REACT_APP_BACKEND_URL;\nconst GET_CHATROOM_ENDPOINT = BACKEND_URL + \"/getchatroom\";\n\nfunction VideoChat() {\n  useEffect(() => {\n    const api = setup();\n    console.log(api);\n    return function cleanup() {\n      api.dispose();\n    };\n  });\n  const location = useLocation();\n  const roomId = location.pathname.split(\"/\")[2];\n  const [showInviteAlert, setShowInviteAlert] = useState(true);\n\n  const hideInviteAlert = () => {\n    setShowInviteAlert(false);\n  };\n\n  const setup = async () => {\n    const getChatRoomURLWithId = `${GET_CHATROOM_ENDPOINT}?id=${roomId}`;\n    const api = await fetch(getChatRoomURLWithId).then(response => {\n      return response.json();\n    }).then(chatroom => {\n      return setupJitsi(chatroom[\"Name\"]);\n    });\n    return api;\n  };\n\n  const setupJitsi = chatName => {\n    const domain = \"meet.jit.si\";\n    const config = {\n      TOOLBAR_BUTTONS: ['microphone', 'camera', 'closedcaptions', 'desktop', 'fullscreen', 'fodeviceselection', 'hangup', 'profile', 'chat', 'recording', 'livestreaming', 'etherpad', 'sharedvideo', 'settings', 'raisehand', 'videoquality', 'filmstrip', 'feedback', 'invite', 'stats', 'shortcuts', 'tileview', 'videobackgroundblur', 'download', 'help', 'mute-everyone']\n    };\n    const options = {\n      roomName: roomId,\n      height: \"100%\",\n      width: \"100%\",\n      parentNode: document.getElementById('jitsi-container'),\n      interfaceConfigOverwrite: config\n    };\n    const api = new window.JitsiMeetExternalAPI(domain, options);\n    api.executeCommand('subject', chatName);\n    return api;\n  };\n\n  return /*#__PURE__*/React.createElement(Stack, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 59,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"container\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 61,\n      columnNumber: 7\n    }\n  }, showInviteAlert && /*#__PURE__*/React.createElement(InviteAlert, {\n    hideInviteAlert: hideInviteAlert,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 62,\n      columnNumber: 29\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 64,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    id: \"jitsi-container\",\n    className: \"jitsi-container\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 65,\n      columnNumber: 9\n    }\n  })));\n}\n\nexport default VideoChat;","map":{"version":3,"sources":["/Users/planetexpress/Documents/Projects/Personal/goodtalk/goodtalk-web/src/components/videochat/videochat.js"],"names":["React","useEffect","useState","useLocation","InviteAlert","Stack","BACKEND_URL","process","env","REACT_APP_BACKEND_URL","GET_CHATROOM_ENDPOINT","VideoChat","api","setup","console","log","cleanup","dispose","location","roomId","pathname","split","showInviteAlert","setShowInviteAlert","hideInviteAlert","getChatRoomURLWithId","fetch","then","response","json","chatroom","setupJitsi","chatName","domain","config","TOOLBAR_BUTTONS","options","roomName","height","width","parentNode","document","getElementById","interfaceConfigOverwrite","window","JitsiMeetExternalAPI","executeCommand"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from \"react\"\nimport { useLocation } from \"react-router-dom\"\nimport \"./videochat.css\"\nimport InviteAlert from \"../invitealert/invitealert\"\nimport { Stack } from \"grommet\"\nconst BACKEND_URL = process.env.REACT_APP_BACKEND_URL\nconst GET_CHATROOM_ENDPOINT = BACKEND_URL + \"/getchatroom\"\nfunction VideoChat() {\n  useEffect(() => {\n    const api = setup()\n    console.log(api)\n\n    return function cleanup() {\n      api.dispose()\n    }\n  })\n  const location = useLocation()\n  const roomId = location.pathname.split(\"/\")[2]\n\n  const [showInviteAlert, setShowInviteAlert] = useState(true)\n  const hideInviteAlert = () => {\n    setShowInviteAlert(false)\n  }\n\n\n  const setup = async () => {\n    const getChatRoomURLWithId = `${GET_CHATROOM_ENDPOINT}?id=${roomId}`\n    const api = await fetch(getChatRoomURLWithId).then((response) => {\n      return response.json()\n    }).then((chatroom) => {\n      return setupJitsi(chatroom[\"Name\"])\n    })\n    return api\n  }\n  const setupJitsi = (chatName) => {\n    const domain = \"meet.jit.si\"\n    const config = {\n      TOOLBAR_BUTTONS: [\n        'microphone', 'camera', 'closedcaptions', 'desktop', 'fullscreen',\n        'fodeviceselection', 'hangup', 'profile', 'chat', 'recording',\n        'livestreaming', 'etherpad', 'sharedvideo', 'settings', 'raisehand',\n        'videoquality', 'filmstrip', 'feedback', 'invite', 'stats', 'shortcuts',\n        'tileview', 'videobackgroundblur', 'download', 'help', 'mute-everyone'\n      ],\n    }\n    const options = {\n      roomName: roomId,\n      height: \"100%\",\n      width: \"100%\",\n      parentNode: document.getElementById('jitsi-container'),\n      interfaceConfigOverwrite: config,\n    }\n\n    const api = new window.JitsiMeetExternalAPI(domain, options);\n    api.executeCommand('subject', chatName);\n    return api;\n  }\n  return (\n    <Stack>\n\n      <div className=\"container\">\n        {showInviteAlert && <InviteAlert hideInviteAlert={hideInviteAlert} />}\n      </div>\n      <div>\n        <div\n          id=\"jitsi-container\"\n          className=\"jitsi-container\"\n        />\n      </div>\n    </Stack>\n  )\n}\n\nexport default VideoChat;"]},"metadata":{},"sourceType":"module"}